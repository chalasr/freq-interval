<!DOCTYPE html>
<html ng-app="aliapur">
  <head>
    <meta charset="utf-8">
    <title>ALIAPUR Jour 1</title>
  </head>
  <body ng-controller="MainCtrl as main">
    <div id="main">
      {{ main.count }} - {{ main.getDatetime | date:'HH:mm:ss' }}
    </div>
    <script type="text/javascript" src="http://cdn.chalasdev.fr/js/jquery.js"></script>
    <script type="text/javascript" src="http://cdn.chalasdev.fr/js/angular.min.js"></script>
    <script type="text/javascript" src="http://cdn.chalasdev.fr/js/angular-route.min.js"></script>
    <script type="text/javascript">
      (function(app){

          function MainCtrl($interval){
              var vm = this;
              this.scope = angular.element('body').scope();
              var currentDate = new Date();
              // var currentDay = this.currentDate.getDate();
              this.workDays = [];
              var day = 13;
              for (var i = 1; i < 6; i++) {
                  if(day < 19) {
                      vm.workDays[day] = {};
                  }
              }
              this.workDays[13] = { count: 0, final: 173844 } // Tuesday 13
              this.workDays[14] = { count: 173844, final: 352572 } // Wednesday 14
              this.workDays[15] = { count: 352572, final: 547800 } // Thursday 15
              this.workDays[16] = { count: 547800, final: 707916 } // Friday 16
              this.workDays[17] = { count: 707916, final: 707916 } // Saturday 17
              //TESTING DAY
              var currentDay = 13;
              //
              vm.init = $interval(function() {
                  vm.getDatetime = new Date();
              }, 1000 );

              this.count = this.workDays[currentDay].count;
              this.finalCount = this.workDays[currentDay].final;
              var freq = 600;
              var increment = this.finalCount / freq;
              console.log(increment);
              this.myInterval = $interval(function() {
                  (vm.count < vm.finalCount) ? (vm.count += increment) : vm.stopInterval();
              }, 500);

              this.stopInterval = function() {
                  $interval.cancel(vm.myInterval);
              };

          };

          app.controller('MainCtrl', MainCtrl);

      })(angular.module('aliapur', ['ngRoute']));

    </script>
  </body>
</html>
